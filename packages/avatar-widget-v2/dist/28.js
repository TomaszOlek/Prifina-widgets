"use strict";(self.webpackChunk_prifina_widgets_avatar_widget_v2=self.webpackChunk_prifina_widgets_avatar_widget_v2||[]).push([[28],{4028:(e,t,a)=>{a.r(t);var n=a(1119),o=a(6470),i=a(513),r=(a(9120),a(5713),a(7162)),s=a.n(r),c=a(7900),u=a.n(c),l=a(2734),d="q5jvWQ9MXhUnUFyotc6L2t",m=a(3280),f=a(1195),p=a(466),w=(0,f.ZP)("div").withConfig({displayName:"Container",componentId:"sc-63a22i-0"})({boxShadow:0,padding:5,borderRadius:10},(0,p.bU)({variants:{small:{height:300,width:300},medium:{height:616,width:616},mediumVertical:{height:616,width:300},mediumHorizontal:{height:300,width:616}}})),h=a(2955),g=a(9776);const v=function(e){var t=e.url,a=e.backgroundColor,n=e.cameraPosition,o=(e.onError,e.onLoading,e.ouraScore),i=(0,c.useRef)(null),r=new h.Clock,s=new h.PerspectiveCamera(25,1,6,1e3),l=new h.Scene,d=new h.Color(a||16777215),m=new h.WebGLRenderer({antialias:!0}),f=[],p=function e(){if(requestAnimationFrame(e),f.length>0)for(var t=0;t<f.length;t++)f[t].update(r.getDelta());m.render(l,s)},w=function(){s.position.set(n.x,n.y,n.z),l.background=d;var e=new h.HemisphereLight(16777215,4473924);e.position.set(0,200,0),l.add(e),(e=new h.DirectionalLight(16777215)).position.set(0,200,100),e.castShadow=!0,e.shadow.camera.top=180,e.shadow.camera.bottom=-100,e.shadow.camera.left=-120,e.shadow.camera.right=120,e=new h.DirectionalLight(16777215),l.add(e),e=new h.AmbientLight(2236962),l.add(e),void 0!==t&&(new g).load(t,(function(e){e.mixer=new h.AnimationMixer(e),e.mixer&&f.push(e.mixer),e.animations[0]&&e.mixer.clipAction(e.animations[0]).play(),e.traverse((function(e){e.isMesh&&(e.castShadow=!0,e.receiveShadow=!0)})),console.log("object",e),l.add(e)}),(function(e){v(e)}),(function(e){b(e)})),m.setPixelRatio(window.devicePixelRatio),m.setSize(290,290),i.current.replaceChildren(m.domElement),p()},v=function(e){},b=function(e){};return(0,c.useEffect)((function(){console.log("component mounted"),w()}),[o]),console.log("should render state",o),console.log("react visor color",a),u().createElement("div",{style:{width:290,height:290,display:"flex",justifyContent:"center",alignItems:"center"},ref:i})},b=function(e){var t=(0,l.usePrifina)(),a=(t.stage,t.check,t.onUpdate),r=t.API,f=t.registerDataConnector,p=(e.score,(0,c.useState)()),h=(0,i.Z)(p,2),g=h[0],b=h[1],y=function(e){console.log("OURA SCORE PROCESS DATA",e);var t=e;console.log("OURA SCORE PROCESSED NEW DATA",t),b(t[1])},E=function(){var e=(0,o.Z)(s().mark((function e(t){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("UPDATE ",t),t.hasOwnProperty("data")&&t.data.hasOwnProperty("content")&&"Oura/queryReadinessSummariesAsync"===t.data.dataconnector&&t.data.content.length>1&&y(t.data.content);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();(0,c.useEffect)((function(){function e(){return(e=(0,o.Z)(s().mark((function e(){var t,o,i,c,u;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a(d,E),f(d,[m.Z]),t=new Date,o=t.setDate(t.getDate()-1),i=new Date(o).toISOString().split("T")[0],c=(0,n.Z)({},"s3::date",(0,n.Z)({},l.Op.gte,i)),e.next=8,r[d].Oura.queryReadinessSummariesAsync({filter:c,fields:"score"});case 8:u=e.sent,console.log("activityResult",u);case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]);var S="https://prifina-data-352681697435-eu-west-1.s3.eu-west-1.amazonaws.com/public/ujWBeKugg514AVaE4UyaDq/native-assets/Idle.fbx",x=S,A="yellow";switch(!0){case g<=64:x="https://prifina-data-352681697435-eu-west-1.s3.eu-west-1.amazonaws.com/public/ujWBeKugg514AVaE4UyaDq/native-assets/AlertState.fbx",A="firebrick";break;case g>=65&&g<=69:x="https://prifina-data-352681697435-eu-west-1.s3.eu-west-1.amazonaws.com/public/ujWBeKugg514AVaE4UyaDq/native-assets/PayAttention.fbx",A="khaki";break;case g>=70&&g<=84:x="https://prifina-data-352681697435-eu-west-1.s3.eu-west-1.amazonaws.com/public/ujWBeKugg514AVaE4UyaDq/native-assets/WellRecovered.fbx",A="mediumseagreen";break;case g>=85:x="https://prifina-data-352681697435-eu-west-1.s3.eu-west-1.amazonaws.com/public/ujWBeKugg514AVaE4UyaDq/native-assets/SurperCharged.fbx",A="powderblue";break;default:x=S,A="gray"}return console.log("status",x),console.log("color",A),u().createElement(w,{variant:"small",style:{border:"5px solid ".concat(A),display:"flex",alignItems:"center",justifyContent:"center",position:"relative"}},u().createElement(v,{id:"canvas",cameraPosition:{x:0,y:95,z:450},url:x,backgroundColor:A,ouraScore:g}),u().createElement("div",{style:{position:"absolute",left:25,bottom:25,fontSize:32,fontWeight:800}},g))};var y=a(953),E=document.getElementById("root");(0,y.createRoot)(E).render(u().createElement(b,null))}}]);